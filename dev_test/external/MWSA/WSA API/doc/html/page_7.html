<!-- HTML header for doxygen 1.8.4-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Moody's SAV"/>
<title>WSA API REFERENCE GUIDE: Stress EDF Credit Model</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo">
    <a href="http://www.moodys.com/index.html">
	 <img alt="Logo" src="project_logo.JPG"/>
	</a>
  </td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">WSA API REFERENCE GUIDE
   &#160;<span id="projectnumber">4.0.1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('page_7.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Stress EDF Credit Model </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="sec_7_0"></a>
Overview</h1>
<p>Stress EDF credit model is composes 2 parts:</p>
<ul>
<li>EDF(expected default frequency) data for each collateral.</li>
<li>Algorithm to project default assumption base on each collaterals' expected default frequency.</li>
</ul>
<p>To project cashflow base on Stress EDF credit model, user need to :</p>
<ol type="1">
<li>Set EDF data for each collateral:<ul>
<li>Set EDF data by applying predefined scenario.</li>
<li>Set EDF data base on user's own judgement.</li>
</ul>
</li>
<li>Call <a class="el" href="ccmo_8h.html#acf68ddb88ebae9fd26d06458f408848e">run_deal_ex()</a>, API will automatically apply algorithm to generate default assumption base on collateral's EDF data.</li>
</ol>
<h1><a class="anchor" id="sec_7_1"></a>
Running a Stress EDF</h1>
<h2><a class="anchor" id="sec_7_1_0"></a>
Step 1: Prerequisite</h2>
<ul>
<li>WSA API version 2.1 or newer.</li>
<li>EDF database file(DEAL_NAME_EDF.DB) exists in the deal file.(The database file is required for Stress EDF Scenario)</li>
<li>Calling <a class="el" href="wsa_8h.html#a52f9130c1e96268fcbf711e3c5b16a71">set_moodys_credit_model_settings()</a> with MOODYS_SEDF_SETTINGS.</li>
</ul>
<h3><a class="anchor" id="sec_7_1_1"></a>
Select Stress EDF credit model</h3>
<p>The very first step to use Stress EDF credit model is calling set_moodys_credit_model() with enumeration MOODYS_SEDF_SETTINGS :</p>
<div class="fragment"><div class="line">*  ...</div>
<div class="line">*   <a class="code" href="ccmo_8h.html#a9fec86c2764699a30bc1f0d93d990e6a">open_deal_ex</a>(tid, pCmo);</div>
<div class="line">*   <a class="code" href="wsa_8h.html#a52f9130c1e96268fcbf711e3c5b16a71">set_moodys_credit_model_settings</a>(tid, <a class="code" href="wsa_8h.html#ab198f12203f8ec8fc2ab341807c7b988a6d8384c2b0022e65fd46d284aa19f1fe">MOODYS_SEDF_SETTINGS</a>, 1);</div>
<div class="line">*  ...</div>
<div class="line">*  </div>
</div><!-- fragment --> <dl class="section warning"><dt>Warning</dt><dd>if the parameter sets_up_only in <a class="el" href="wsa_8h.html#a52f9130c1e96268fcbf711e3c5b16a71">set_moodys_credit_model_settings()</a> set to 0, API will set prepay assumption with 30 CPR and recovery lag with 15. <br/>
 These prepay/recovery assumption won't be overrided by either <a class="el" href="ccmo_8h.html#afd1f443f7caebcadcd68683c4cf29295">set_prepayments_ex()</a> or <a class="el" href="ccmo_8h.html#aba900e55ba55d7ed654ef56b6284843c">set_recovery_lag_ex()</a></dd></dl>
<h3><a class="anchor" id="sec_7_1_2"></a>
Settlement date</h3>
<p>If user open a deal with a settlement date at <a class="el" href="struct_c_m_o___s_t_r_u_c_t.html#a19399bd919ce260471da370503a5c083">CMO_STRUCT::settlement_date</a>, like: </p>
<div class="fragment"><div class="line">*  ...</div>
<div class="line">*   <span class="keywordtype">char</span> deal_id[9] = <span class="stringliteral">&quot;JUBILEE4&quot;</span>;</div>
<div class="line">*   <a class="code" href="struct_c_m_o___s_t_r_u_c_t.html">CMO_STRUCT</a> *pCmo = <span class="keyword">new</span> <a class="code" href="struct_c_m_o___s_t_r_u_c_t.html">CMO_STRUCT</a>();</div>
<div class="line">*   pCmo-&gt;<a class="code" href="struct_c_m_o___s_t_r_u_c_t.html#a4cdda3b33cd68a907679237ff61fe6d9">actual_coll</a> = 1;</div>
<div class="line">*   strncpy_s(pCmo-&gt;<a class="code" href="struct_c_m_o___s_t_r_u_c_t.html#a01c5eaff1227ade8809330e804edba14">dealid</a>, deal_id, <span class="keyword">sizeof</span>(deal_id));</div>
<div class="line">*   strncpy_s(pCmo-&gt;<a class="code" href="struct_c_m_o___s_t_r_u_c_t.html#a19399bd919ce260471da370503a5c083">settlement_date</a>, <span class="stringliteral">&quot;06/15/2014&quot;</span>, 10);</div>
<div class="line">*   <a class="code" href="ccmo_8h.html#a9fec86c2764699a30bc1f0d93d990e6a">open_deal_ex</a>(tid, pCmo);</div>
<div class="line">*  ...</div>
<div class="line">*  </div>
</div><!-- fragment --><p> API will load EDF data as of June,2014 from local EDF database after calling <a class="el" href="wsa_8h.html#a52f9130c1e96268fcbf711e3c5b16a71">set_moodys_credit_model_settings()</a>. <br/>
 If no EDF data available for settlement date, API will pick nearest available EDF data. <br/>
 If user doesn't specify settlement date when he opens the deal, API will load latest available EDF data for Stress EDF run.</p>
<h2><a class="anchor" id="sec_7_2"></a>
Step 2 : Setting Stress EDF data</h2>
<p>There are 2 sources setting Stress EDF data, one is loaded from local Stress EDF database, the other is set custom EDF data.</p>
<h3><a class="anchor" id="sec_7_2_0"></a>
Run Stress EDF with predefined scenario</h3>
<p>API provide a list of pre-defined macro economy scenarios for Stress EDF. User can select one of the scenarios to run Stress EDF mode. <br/>
 Base on different economy scenario, each collateral will be apply with different default probabilities. Stress EDF will project collateral default principals base on these default probabilities. <br/>
 </p>
<h2>Get scenario list</h2>
<p>To get full list of scenarios avaiable in current EDF database, user need to call <a class="el" href="wsa_8h.html#a8508a43f6e9937dc10737db74380f5b4">get_edf_scenarios()</a>.</p>
<ol type="1">
<li>Get the number of scenarios avaialble <div class="fragment"><div class="line">*  ...</div>
<div class="line">*   <span class="comment">// make sure .SFW deal file has EDF database.</span></div>
<div class="line">*   <span class="comment">// get the number of all avaible EDF scenarios in database.</span></div>
<div class="line">*   <span class="keywordtype">int</span> num_edf_scenarios = <a class="code" href="wsa_8h.html#a8508a43f6e9937dc10737db74380f5b4">get_edf_scenarios</a>(tid, NULL);</div>
<div class="line">*   printf(<span class="stringliteral">&quot;%d scenarios found \n&quot;</span>, num_edf_scenarios);</div>
<div class="line">*  ...</div>
<div class="line">*  </div>
</div><!-- fragment --></li>
<li>Populate scneario names <div class="fragment"><div class="line">*  ...</div>
<div class="line">*   <span class="keywordtype">char</span> * scenario_list[9];</div>
<div class="line">*   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;num_edf_scenarios;i++){</div>
<div class="line">*       scenario_list[i] = (<span class="keywordtype">char</span> *)malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) * 20);</div>
<div class="line">*   }</div>
<div class="line">*  </div>
<div class="line">*   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;num_edf_scenarios;i++){</div>
<div class="line">*       printf(<span class="stringliteral">&quot;name of scenario %d: %s \n&quot;</span>, i,scenario_list[i]);</div>
<div class="line">*   }</div>
<div class="line">*  ...</div>
<div class="line">*  </div>
</div><!-- fragment --></li>
</ol>
<h2>Set/view current scenario</h2>
<div class="fragment"><div class="line">*  ...</div>
<div class="line">*     <span class="comment">// set scenario 3, 3 is the index of scenarios return by get_edf_scenarios()</span></div>
<div class="line">*     <a class="code" href="wsa_8h.html#a221f4e10cb77347a753ead389e60f85e">set_current_edf_scenario</a>(tid, 3);</div>
<div class="line">*  ... </div>
<div class="line">*  </div>
</div><!-- fragment --><h2>View EDF(expected default frequency) data</h2>
<p>After user select scenario by calling <a class="el" href="wsa_8h.html#a221f4e10cb77347a753ead389e60f85e">set_current_edf_scenario()</a>, API will apply default probabilities to collaterals. <br/>
 User can inspect these default value by calling <a class="el" href="wsa_8h.html#ab012c9e83d6b1b8429b2b0f95bf6eb5b">get_loan_edf()</a></p>
<div class="fragment"><div class="line">*  ...</div>
<div class="line">*   <a class="code" href="ccmo_8h.html#acf68ddb88ebae9fd26d06458f408848e">run_deal_ex</a>(tid,pCmo)</div>
<div class="line">*   <span class="comment">// create an array to hold collateral edf data</span></div>
<div class="line">*   <span class="keywordtype">double</span> edf_loan_data[5] = {0.0};</div>
<div class="line">*   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i =1;i&lt;=pCmo-&gt;<a class="code" href="struct_c_m_o___s_t_r_u_c_t.html#a4d23e60dc298e5e9daff26419f3b51b0">num_colls</a>;i++){</div>
<div class="line">*       <span class="comment">// popluate collateral loan edf data</span></div>
<div class="line">*       <a class="code" href="wsa_8h.html#ab012c9e83d6b1b8429b2b0f95bf6eb5b">get_loan_edf</a>(tid, NULL,i,edf_loan_data,5);</div>
<div class="line">*       printf(<span class="stringliteral">&quot;Coll_num:%d, default probability in year 1:%f,  default probability in year 2:%f \n&quot;</span>, i,edf_loan_data[0], edf_loan_data[1]);</div>
<div class="line">*   }</div>
<div class="line">*  ... </div>
<div class="line">*  </div>
</div><!-- fragment --><h3><a class="anchor" id="sec_7_3"></a>
Run Stress EDF with customized EDF data</h3>
<p>API also provide function "set_loan_edf()" enable user to set EDF data base on their own judgenment.</p>
<div class="fragment"><div class="line">*  ...</div>
<div class="line">*   <span class="keywordtype">double</span> edf_loan_data[5] = {0.0};</div>
<div class="line">*   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i =1;i&lt;=pCmo-&gt;<a class="code" href="struct_c_m_o___s_t_r_u_c_t.html#a4d23e60dc298e5e9daff26419f3b51b0">num_colls</a>;i++){</div>
<div class="line">*       <a class="code" href="wsa_8h.html#ab012c9e83d6b1b8429b2b0f95bf6eb5b">get_loan_edf</a>(tid, NULL,i,edf_loan_data,5);</div>
<div class="line">*       printf(<span class="stringliteral">&quot;Coll_num:%d, dp in year 4:%f,  dp in year 5:%f \n&quot;</span>, i,edf_loan_data[3], edf_loan_data[4]);</div>
<div class="line">*          <span class="comment">//scale up 20% for default probability in year 5</span></div>
<div class="line">*       edf_loan_data[4] *= 1.2;</div>
<div class="line">*          <span class="comment">//scale up 10% for default probability in year 4</span></div>
<div class="line">*       edf_loan_data[3] *= 1.1;</div>
<div class="line">*          <span class="comment">//set modified EDF data back to API</span></div>
<div class="line">*       <a class="code" href="wsa_8h.html#a6ea187addf335b14e4c5fd7cb7976ecd">set_loan_edf</a>(tid, NULL, i, edf_loan_data, 5);</div>
<div class="line">*          <span class="comment">//check the EDF data set</span></div>
<div class="line">*       <a class="code" href="wsa_8h.html#ab012c9e83d6b1b8429b2b0f95bf6eb5b">get_loan_edf</a>(tid, NULL, i, edf_loan_data, 5);</div>
<div class="line">*       printf(<span class="stringliteral">&quot;Coll_num:%d, dp in year 4:%f,  dp in year 5:%f \n&quot;</span>, i,edf_loan_data[3], edf_loan_data[4]);</div>
<div class="line">*   }</div>
<div class="line">*  ...</div>
<div class="line">*  </div>
</div><!-- fragment --><h2><a class="anchor" id="sec_7_4"></a>
Step 3 : Applying user assumption</h2>
<dl class="section warning"><dt>Warning</dt><dd>user assumption can only be applied if user call <a class="el" href="wsa_8h.html#a52f9130c1e96268fcbf711e3c5b16a71">set_moodys_credit_model_settings()</a> with sets_up_only=1. <br/>
 If <a class="el" href="wsa_8h.html#a52f9130c1e96268fcbf711e3c5b16a71">set_moodys_credit_model_settings()</a> called with sets_up_only=0. API will use hard-coded scenario : Prepayment: 30% CPR and 15 months recovery lag. <br/>
</dd></dl>
<h2>Set a prepayment</h2>
<p>When running with Stress EDF credit model, user are also able to apply prepayment assumption on deal level. Please refer to <a class="el" href="ccmo_8h.html#afd1f443f7caebcadcd68683c4cf29295">set_prepayments_ex()</a>.</p>
<h2>Set a default multiplier</h2>
<p>User can scale up or scale down the default assumption by calling <a class="el" href="wsa_8h.html#a4aec5892ce40a44b5830eb2ec7e1f2de">set_edf_default_multiplier()</a>.</p>
<div class="fragment"><div class="line">*  ...</div>
<div class="line">*      <span class="comment">// this will scale up defaults to 5% higher than original Stress EDF defaults amount.</span></div>
<div class="line">*      <a class="code" href="wsa_8h.html#a4aec5892ce40a44b5830eb2ec7e1f2de">set_edf_default_multiplier</a>(tid, 1.05);</div>
<div class="line">*  ...</div>
<div class="line">*  </div>
</div><!-- fragment --><h2><a class="anchor" id="sec_7_5"></a>
Step 4 : Getting cashflow result</h2>
<p>The way getting the cashflow after running Stress EDF is the same way as running a normal deal in WSA API. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.4-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed May 22 2019 21:18:34 for WSA API REFERENCE GUIDE by
    <a href="http://www.moodysanalytics.com/">
   Moody's Analytics SAV</a> </li>
  </ul>
</div>
</body>
</html>
