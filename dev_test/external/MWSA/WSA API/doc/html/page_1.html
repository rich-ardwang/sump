<!-- HTML header for doxygen 1.8.4-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Moody's SAV"/>
<title>WSA API REFERENCE GUIDE: Moody’s Analytics WSA API Overview</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo">
    <a href="http://www.moodys.com/index.html">
	 <img alt="Logo" src="project_logo.JPG"/>
	</a>
  </td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">WSA API REFERENCE GUIDE
   &#160;<span id="projectnumber">4.0.1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('page_1.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Moody’s Analytics WSA API Overview </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#sec_1_1">Downloading Library Content</a></li>
<li class="level1"><a href="#sec_1_2">General programming procedure</a><ul><li class="level2"><a href="#subsec_1_1_1">Part 1 - Initialization of the Library</a></li>
<li class="level2"><a href="#subsec_1_1_2">Part 2 - Thread Safety</a></li>
<li class="level2"><a href="#subsec_1_1_3">Part 3 - Error Handling</a></li>
<li class="level2"><a href="#subsec_1_1_4">Part 4 - Loading the Deal</a></li>
<li class="level2"><a href="#subsec_1_1_5">Part 5 - Reviewing the Deal Collateral and Capital Structures</a><ul><li class="level3"><a href="#ssub_1_1_5_1">Viewing Bond Information</a></li>
<li class="level3"><a href="#ssub_1_1_5_2">Viewing Group Information</a></li>
<li class="level3"><a href="#ssub_1_1_5_3">Viewing Bond Collateral</a></li>
<li class="level3"><a href="#ssub_1_1_5_4">Viewing Reremic Deals</a></li>
<li class="level3"><a href="#ssub_1_1_5_5">Viewing Parameters of Reremic Deals</a></li>
</ul>
</li>
<li class="level2"><a href="#subsec_1_1_6">Part 6 - Running the Cashflows</a><ul><li class="level3"><a href="#ssub_1_1_6_1">Levels of Control</a></li>
<li class="level3"><a href="#ssub_1_1_6_2">Setting Collateral Assumptions</a></li>
<li class="level3"><a href="#ssub_1_1_6_3">Setting Interest Rates</a></li>
<li class="level3"><a href="#ssub_1_1_6_4">Running the Cashflows</a></li>
</ul>
</li>
<li class="level2"><a href="#subsec_1_1_7">Part 7 - Force Obtaining Results of the Cashflows</a><ul><li class="level3"><a href="#ssub_1_1_7_1">Obtaining Collateral Cashflow</a></li>
<li class="level3"><a href="#ssub_1_1_7_2">Obtaining Bond Cashflow</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p>The Moody’s Analytics WSA API projects cashflows for CMOs/Remics and Asset-Backed Securities based on scenario information. The scenario information is based on environmental factors (such as market rates), deal-specific characteristics (such as prepayment and default rates) and the status of the deal (which is updated monthly).</p>
<h1><a class="anchor" id="sec_1_1"></a>
Downloading Library Content</h1>
<p>Use the separate download tool and corresponding instructions to download deal files.</p>
<h1><a class="anchor" id="sec_1_2"></a>
General programming procedure</h1>
<h2><a class="anchor" id="subsec_1_1_1"></a>
Part 1 - Initialization of the Library</h2>
<p>The first step to projecting cashflows is to initialize the API (automatic in Windows) and let the API know where the data files are located (using <a class="el" href="ccmo_8h.html#a2da9487ad083f0bab496f9b9afe8850f">set_input_path()</a>) and the locations of any integrated forecast models. </p>
<dl class="section note"><dt>Note</dt><dd>The WSA API is compatible with 32-bit and 64-bit Windows and 32-bit and 64-bit Linux.</dd></dl>
<h2><a class="anchor" id="subsec_1_1_2"></a>
Part 2 - Thread Safety</h2>
<p>The API has old (single-threaded) as well as new (multi-threaded) levels. To run libraries safely in a multi-threaded environment, user needs to obtain a thread specific identifier for each thread. The API can be used in a thread-safe manner provided:</p>
<ol type="1">
<li>All data and model paths are set in the main thread before creating the deal scenario objects</li>
<li>Each deal scenario object has a distinct log file name.</li>
<li>The maximum number of deal scenario objects (dso) is set before creating dso’s.</li>
<li>Each dso is active in only one thread at a time (it can be created in one thread, but processed in another).</li>
<li>No functions marked as not thread-safe are used.</li>
</ol>
<p>Call <a class="el" href="ccmo_8h.html#ab025128aaeab8b60287f9737042a0b23">create_deal_scenario_object()</a>. Thread ID should be passed to every API function working in a given thread. If a thread ID is not created, and NULL is passed as the thread ID, a “default” dso is used. This is not thread safe!</p>
<dl class="section warning"><dt>Warning</dt><dd>Make sure to call <a class="el" href="ccmo_8h.html#a43485c7beba00b3d8bd349537d75cd32">release_deal_scenario_object()</a> at the completion of the thread. Failure to do so will result in significant memory leaks.</dd></dl>
<h3>Concurrent Deals:</h3>
<p>Follow the thread-safety guidelines if more than one deal will be open at a time.</p>
<h2><a class="anchor" id="subsec_1_1_3"></a>
Part 3 - Error Handling</h2>
<p>Most WSA API functions return an integer value, where a negative integer indicates an error. To obtain the text message of the error, user should call <a class="el" href="ccmo_8h.html#a167078d11a7d4e91373611a29e2a21b4">get_deal_error_msg()</a>. </p>
<dl class="section note"><dt>Note</dt><dd>Moody’s Analytics strongly encourages users to call this function following every API call.<br/>
 To set up a log file, call <a class="el" href="ccmo_8h.html#a3553fbb95f73641fab081d2df38c7a71">set_log_options()</a>. If a user wants to control which errors will stop the process or not, call <a class="el" href="ccmo_8h.html#aff39589b058a06579480914bdf4884ae">set_error_handling_level()</a>.</dd></dl>
<h2><a class="anchor" id="subsec_1_1_4"></a>
Part 4 - Loading the Deal</h2>
<dl class="section note"><dt>Note</dt><dd>Loading an SFW deal is the same as loading a CHS deal.</dd></dl>
<p>A deal can be loaded by calling <a class="el" href="ccmo_8h.html#a9fec86c2764699a30bc1f0d93d990e6a">open_deal_ex()</a>. User provides input fields by calling <a class="el" href="ccmo_8h.html#a9fec86c2764699a30bc1f0d93d990e6a">open_deal_ex()</a>.</p>
<p>Important inputs:</p>
<ul>
<li>dealid - Name of the deal/CHS or the SFW file provided by Moody’s Analytics</li>
<li>actual_coll - Controls level of collateral; value 0 indicates repline-level, value 1 indicates loan-level</li>
<li>settlement_date - Has to be provided in format MM/DD/YY</li>
<li>get_markit_id - Helps user convert the CUSIP ISIN to Moody’s Analytics deal name and tranche name.</li>
<li>get_deal_info - Allows the user to examine the status of the deal loading (particularly whether the deal was loaded under the loan level, repline level, the date of the last update file used, etc.).</li>
</ul>
<dl class="section warning"><dt>Warning</dt><dd>Make sure to call <a class="el" href="ccmo_8h.html#a9a4fa1bf638cb2504b6d575bfdfa3045">close_deal_ex()</a> after you have finished working with the open deal. Failure to do so will generate significant memory leaks.</dd></dl>
<h2><a class="anchor" id="subsec_1_1_5"></a>
Part 5 - Reviewing the Deal Collateral and Capital Structures</h2>
<h3><a class="anchor" id="ssub_1_1_5_1"></a>
Viewing Bond Information</h3>
<p>Call <a class="el" href="ccmo_8h.html#aff4581764ee945b6ef3f4b3415c6af1c">view_all_bonds_ex()</a> to see all bonds in a deal.</p>
<h3><a class="anchor" id="ssub_1_1_5_2"></a>
Viewing Group Information</h3>
<p>Call <a class="el" href="ccmo_8h.html#ac6ebc4905bae49b3ce2ce09ea48f9836">view_coll_groups()</a> to see all collateral groups in the deal.</p>
<h3><a class="anchor" id="ssub_1_1_5_3"></a>
Viewing Bond Collateral</h3>
<p>Call <a class="el" href="ccmo_8h.html#a44dce7a94359aea724a4374f5fcd59da">view_colls_ex()</a> to load all collateral data into array.</p>
<p>Moody’s Analytics encourages users to use these functions:</p>
<ul>
<li><a class="el" href="ccmo_8h.html#a503fc99cbd63b3dd9f240567346116e4">obtain_collat_iterator()</a></li>
<li><a class="el" href="ccmo_8h.html#ae568bf323c77a0269e15308fe76610a1">get_next_collat()</a></li>
</ul>
<h3><a class="anchor" id="ssub_1_1_5_4"></a>
Viewing Reremic Deals</h3>
<p>Call <a class="el" href="ccmo_8h.html#a79f887ca7b4fca96a30b31c1f59527f4">view_reremic_deals()</a> to view reremic deals.</p>
<h3><a class="anchor" id="ssub_1_1_5_5"></a>
Viewing Parameters of Reremic Deals</h3>
<p>Most of the functions in the API have a counterpart for manipulating the reremic deals. For example, <a class="el" href="ccmo_8h.html#a7ac04b921226ec8068ab963cd611c2b4">view_reremic_colls_ex()</a> allows users to see all of their collaterals of the reremic deal designated with deal ID. Some new functions can work on both parent and children deals. For example, <a class="el" href="ccmo_8h.html#a503fc99cbd63b3dd9f240567346116e4">obtain_collat_iterator()</a> has the following parameter: reremic_deal_id_or_null. This indicates whether to access a particular child deal or a parent deal.</p>
<h2><a class="anchor" id="subsec_1_1_6"></a>
Part 6 - Running the Cashflows</h2>
<h3><a class="anchor" id="ssub_1_1_6_1"></a>
Levels of Control</h3>
<p>By default, Moody’s Analytics WSA API uses its own collateral files and user supplied assumption parameters to amortize the collateral and distribute cashflows between bonds. User can pre-empt some of those functions. For example, user can provide their own collateral information using the function: <a class="el" href="ccmo_8h.html#a870663b9a59e1cb36e17012dcb9036e8">replace_collateral()</a>. User also can decide to generate collateral cashflows by themselves and rely on the WSA API only for distributing cashflow among the bonds. The functions are:</p>
<ul>
<li><a class="el" href="ccmo_8h.html#a7475eac22c105a0ff0800b4bae47bf1f">set_custom_amortization_ex()</a></li>
<li><a class="el" href="ccmo_8h.html#a90661ac3c69836b4174d1ab6dade6230">set_collateral_flow_ex()</a> </li>
</ul>
<h3><a class="anchor" id="ssub_1_1_6_2"></a>
Setting Collateral Assumptions</h3>
<p>User can set deal level or collateral level assumptions using the following functions:</p>
<ul>
<li><a class="el" href="ccmo_8h.html#afd1f443f7caebcadcd68683c4cf29295">set_prepayments_ex()</a></li>
<li><a class="el" href="ccmo_8h.html#a621873ddd2a88ae49a4dac4e0569d774">set_defaults_ex()</a></li>
<li><a class="el" href="ccmo_8h.html#a4fd943897b3e89f9c74f27f4cdd7e2b4">set_recoveries_ex()</a></li>
<li><a class="el" href="ccmo_8h.html#aba900e55ba55d7ed654ef56b6284843c">set_recovery_lag_ex()</a></li>
<li><a class="el" href="ccmo_8h.html#a2aa933452d58f92c92278f8afa7ebc4c">set_service_advances_ex()</a></li>
</ul>
<p>User can also use pr collateral per period callback functions to set the assumptions. Use the following set of functions:</p>
<ul>
<li><a class="el" href="ccmo_8h.html#a68411a18ba456a9aa15da9c12fa9d3c2">install_per_period_assump_cb()</a></li>
<li><a class="el" href="ccmo_8h.html#a1a1336c32fb3004c562428a7e5050ad2">install_collat_assump_cb()</a></li>
<li><a class="el" href="ccmo_8h.html#a3974c48bccdfc781ddb1f202cb66d078">set_user_data_for_cb()</a></li>
<li><a class="el" href="ccmo_8h.html#a8cdcfb7f082579a086001c8622075694">get_user_data_for_cb()</a></li>
<li><a class="el" href="ccmo_8h.html#ac3bc818036ea11185d8a96b60d0435cd">install_user_cleanup_cb()</a> </li>
</ul>
<h3><a class="anchor" id="ssub_1_1_6_3"></a>
Setting Interest Rates</h3>
<p>Call <a class="el" href="ccmo_8h.html#ab515893564534c0089a2feb0dfc53612">set_rate_ex()</a> to set a particular forward rate.</p>
<p>Call get_rates() to see which rates are required by a given deal. </p>
<dl class="section note"><dt>Note</dt><dd>If a necessary rate is not supplied, value of zero is used. No error message is generated. </dd></dl>
<h3><a class="anchor" id="ssub_1_1_6_4"></a>
Running the Cashflows</h3>
<p>After all of the assumptions are set, user should run this function <a class="el" href="ccmo_8h.html#acf68ddb88ebae9fd26d06458f408848e">run_deal_ex()</a> to request the API to perform the calculation.</p>
<h2><a class="anchor" id="subsec_1_1_7"></a>
Part 7 - Force Obtaining Results of the Cashflows</h2>
<h3><a class="anchor" id="ssub_1_1_7_1"></a>
Obtaining Collateral Cashflow</h3>
<p>Call <a class="el" href="ccmo_8h.html#aab913df0bd6bb7247db2988c72db97fa">get_cf_date()</a> use this function to obtain dates of the collateral cashflow.</p>
<p>Call <a class="el" href="ccmo_8h.html#a491f45b55e4ce48c00415b4b83f01025">get_collateral_flow_ex()</a> to obtain values of the collateral cashflow.</p>
<p>Call <a class="el" href="ccmo_8h.html#a55135aec7f740adeff41f085937f131e">get_collateral_flow_ex1()</a> to obtain all collateral cashflow information in one function. </p>
<h3><a class="anchor" id="ssub_1_1_7_2"></a>
Obtaining Bond Cashflow</h3>
<p>Call <a class="el" href="ccmo_8h.html#aab913df0bd6bb7247db2988c72db97fa">get_cf_date()</a> to obtain dates of the bond cashflow.</p>
<p>Call <a class="el" href="ccmo_8h.html#a292eec0ddaa786ac39ea8f1b35085832">get_bond_flow_ex()</a> to obtain values of the bond cashflow.</p>
<p>Call <a class="el" href="ccmo_8h.html#af1da298150eafeb6f707f2792d36c049">get_bond_flow_ex1()</a> to obtain all bond cashflow information in one function. The function also adds historical cashflows to which some zero delay tranches are entitled.</p>
<p>The following chapters describes the files and the preferred locations for installing them, followed by an explanation of the pre-processing directives, structures used, an overview of the functions, and detailed information about each function. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.4-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed May 22 2019 21:18:34 for WSA API REFERENCE GUIDE by
    <a href="http://www.moodysanalytics.com/">
   Moody's Analytics SAV</a> </li>
  </ul>
</div>
</body>
</html>
