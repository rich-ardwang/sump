<!-- HTML header for doxygen 1.8.4-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Moody's SAV"/>
<title>WSA API REFERENCE GUIDE: How To</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo">
    <a href="http://www.moodys.com/index.html">
	 <img alt="Logo" src="project_logo.JPG"/>
	</a>
  </td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">WSA API REFERENCE GUIDE
   &#160;<span id="projectnumber">4.0.1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('page_9.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">How To </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="page_9_1"></a>
How to get cashflows result</h1>
<p>After a deal run by calling <a class="el" href="ccmo_8h.html#acf68ddb88ebae9fd26d06458f408848e">run_deal_ex()</a>, user are able to get both collateral cashflows and bond cashflows.</p>
<h2><a class="anchor" id="sec_9_1_1"></a>
Collateral cashflow</h2>
<p>There are 2 ways to retrieve collateral cashflows. <br/>
 Either by calling <a class="el" href="ccmo_8h.html#a491f45b55e4ce48c00415b4b83f01025">get_collateral_flow_ex()</a> to get a single flows or by calling <a class="el" href="ccmo_8h.html#a55135aec7f740adeff41f085937f131e">get_collateral_flow_ex1()</a> to popluate structure <a class="el" href="struct_m_a_r_k_i_t___c_o_l_l_a_t___c_a_s_h_f_l_o_w.html" title="This structure is used to provide user with collateral cashflow. It includes number of cashflow point...">MARKIT_COLLAT_CASHFLOW</a>. <br/>
 </p>
<h2>Collateral Groups</h2>
<p>A deal may has more than one group of collaterals. API provide function <a class="el" href="ccmo_8h.html#ac6ebc4905bae49b3ce2ce09ea48f9836">view_coll_groups()</a> to get all group numbers.</p>
<div class="fragment"><div class="line">*  ...</div>
<div class="line">*   <span class="comment">//get total number of collateral groups</span></div>
<div class="line">*   <span class="keywordtype">int</span> num_of_groups = 0 ;</div>
<div class="line">*   <a class="code" href="ccmo_8h.html#ac6ebc4905bae49b3ce2ce09ea48f9836">view_coll_groups</a>(tid,NULL, NULL,&amp;num_of_groups); </div>
<div class="line">*   printf(<span class="stringliteral">&quot;Number of collateral groups: %d \n&quot;</span>, num_of_groups);</div>
<div class="line">*  </div>
<div class="line">*   <span class="comment">//get group number in an array</span></div>
<div class="line">*   <span class="keywordtype">int</span> * groups_array;</div>
<div class="line">*   groups_array = (<span class="keywordtype">int</span>*)malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)*num_of_groups);</div>
<div class="line">*   <span class="comment">//popluate groups_array by calling view_coll_groups()</span></div>
<div class="line">*   <a class="code" href="ccmo_8h.html#ac6ebc4905bae49b3ce2ce09ea48f9836">view_coll_groups</a>(tid, groups_array ,num_of_groups, &amp;num_of_groups);</div>
<div class="line">*   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;num_of_groups;i++)</div>
<div class="line">*       printf(<span class="stringliteral">&quot;Group Number: %d \n&quot;</span>, groups_array[i]);</div>
<div class="line">*  ...</div>
<div class="line">*  </div>
</div><!-- fragment --><h2><a class="el" href="ccmo_8h.html#a55135aec7f740adeff41f085937f131e">get_collateral_flow_ex1()</a></h2>
<p>User should use <a class="el" href="ccmo_8h.html#a55135aec7f740adeff41f085937f131e">get_collateral_flow_ex1()</a> if he wants to :</p>
<ul>
<li>Getting a set of collateral cashflows by calling API function once</li>
<li>Getting underlying deal's collateral cashflow</li>
</ul>
<p>if group_number = 0, API will popluate <a class="el" href="struct_m_a_r_k_i_t___c_o_l_l_a_t___c_a_s_h_f_l_o_w.html" title="This structure is used to provide user with collateral cashflow. It includes number of cashflow point...">MARKIT_COLLAT_CASHFLOW</a> with deal level collateral cashflow if reremic_deal_id_or_null = NULL, API will popluate <a class="el" href="struct_m_a_r_k_i_t___c_o_l_l_a_t___c_a_s_h_f_l_o_w.html" title="This structure is used to provide user with collateral cashflow. It includes number of cashflow point...">MARKIT_COLLAT_CASHFLOW</a> with current(top deal) collateral cashflow</p>
<div class="fragment"><div class="line">*  ...</div>
<div class="line">*   <a class="code" href="ccmo_8h.html#acf68ddb88ebae9fd26d06458f408848e">run_deal_ex</a>(tid, pCmo);</div>
<div class="line">*      <span class="comment">//new a MARKIT_COLLAT_CASHFLOW to hold collateral flow</span></div>
<div class="line">*   <a class="code" href="struct_m_a_r_k_i_t___c_o_l_l_a_t___c_a_s_h_f_l_o_w.html">MARKIT_COLLAT_CASHFLOW</a> *mcc = <span class="keyword">new</span> <a class="code" href="struct_m_a_r_k_i_t___c_o_l_l_a_t___c_a_s_h_f_l_o_w.html">MARKIT_COLLAT_CASHFLOW</a>();</div>
<div class="line">*      <span class="comment">//popluate MARKIT_COLLAT_CASHFLOW by calling get_collateral_flow_ex1()</span></div>
<div class="line">*   <a class="code" href="ccmo_8h.html#a55135aec7f740adeff41f085937f131e">get_collateral_flow_ex1</a>(tid, 0, NULL, mcc);</div>
<div class="line">*      <span class="comment">//inspect collateral cashflow result</span></div>
<div class="line">*   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;mcc-&gt;<a class="code" href="struct_m_a_r_k_i_t___c_o_l_l_a_t___c_a_s_h_f_l_o_w.html#a64630e15aa74d88418f5034aae5d07ef">size</a>;i++)</div>
<div class="line">*       printf(<span class="stringliteral">&quot;date:%d, balance:%f, default:%f \n&quot;</span>,mcc-&gt;<a class="code" href="struct_m_a_r_k_i_t___c_o_l_l_a_t___c_a_s_h_f_l_o_w.html#a76867b6a5bbe6173852b265c68e7a50b">dates</a>[i], mcc-&gt;<a class="code" href="struct_m_a_r_k_i_t___c_o_l_l_a_t___c_a_s_h_f_l_o_w.html#aa63815f256ad89b3b2efa231012fbb7f">balance</a>[i],mcc-&gt;<a class="code" href="struct_m_a_r_k_i_t___c_o_l_l_a_t___c_a_s_h_f_l_o_w.html#acd137cd3bd8436520f6ac07567ff0a2d">defaults</a>[i]);</div>
<div class="line">*  ...</div>
<div class="line">*  </div>
</div><!-- fragment --><h3>Get collateral cashflow from underlying deal</h3>
<p>For example, there is a top deal with deal_id "CML12004-I" and it has an underlying deal with deal_id "CHL06HB1".</p>
<div class="fragment"><div class="line">*  ...</div>
<div class="line">*   <a class="code" href="ccmo_8h.html#acf68ddb88ebae9fd26d06458f408848e">run_deal_ex</a>(tid, pCmo);</div>
<div class="line">*   <a class="code" href="struct_m_a_r_k_i_t___c_o_l_l_a_t___c_a_s_h_f_l_o_w.html">MARKIT_COLLAT_CASHFLOW</a> *mcc = <span class="keyword">new</span> <a class="code" href="struct_m_a_r_k_i_t___c_o_l_l_a_t___c_a_s_h_f_l_o_w.html">MARKIT_COLLAT_CASHFLOW</a>();</div>
<div class="line">*   <span class="comment">// this will populate deal level collateral cashflow from underlying deal &quot;CHL06HB1&quot;</span></div>
<div class="line">*   <a class="code" href="ccmo_8h.html#a55135aec7f740adeff41f085937f131e">get_collateral_flow_ex1</a>(tid, 0, <span class="stringliteral">&quot;CHL06HB1&quot;</span>, mcc);</div>
<div class="line">*   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;mcc-&gt;<a class="code" href="struct_m_a_r_k_i_t___c_o_l_l_a_t___c_a_s_h_f_l_o_w.html#a64630e15aa74d88418f5034aae5d07ef">size</a>;i++)</div>
<div class="line">*       printf(<span class="stringliteral">&quot;date:%d, balance:%f, default:%f \n&quot;</span>,mcc-&gt;<a class="code" href="struct_m_a_r_k_i_t___c_o_l_l_a_t___c_a_s_h_f_l_o_w.html#a76867b6a5bbe6173852b265c68e7a50b">dates</a>[i], mcc-&gt;<a class="code" href="struct_m_a_r_k_i_t___c_o_l_l_a_t___c_a_s_h_f_l_o_w.html#aa63815f256ad89b3b2efa231012fbb7f">balance</a>[i],mcc-&gt;<a class="code" href="struct_m_a_r_k_i_t___c_o_l_l_a_t___c_a_s_h_f_l_o_w.html#acd137cd3bd8436520f6ac07567ff0a2d">defaults</a>[i]);</div>
<div class="line">*  ...</div>
<div class="line">*  </div>
</div><!-- fragment --><h2><a class="el" href="ccmo_8h.html#a491f45b55e4ce48c00415b4b83f01025">get_collateral_flow_ex()</a></h2>
<p><a class="el" href="struct_m_a_r_k_i_t___c_o_l_l_a_t___c_a_s_h_f_l_o_w.html" title="This structure is used to provide user with collateral cashflow. It includes number of cashflow point...">MARKIT_COLLAT_CASHFLOW</a> only provides a limit number of collateral flows. API provide <a class="el" href="ccmo_8h.html#a491f45b55e4ce48c00415b4b83f01025">get_collateral_flow_ex()</a> to offer more collateral flows. <br/>
 User should use this function if he want to inspect cashflows that wasn't included in <a class="el" href="struct_m_a_r_k_i_t___c_o_l_l_a_t___c_a_s_h_f_l_o_w.html" title="This structure is used to provide user with collateral cashflow. It includes number of cashflow point...">MARKIT_COLLAT_CASHFLOW</a>.</p>
<dl class="section note"><dt>Note</dt><dd>Full list of available identifier : EXTENDED_FLOW_COLLATERAL_IDENTIFIER</dd></dl>
<div class="fragment"><div class="line">*  ...</div>
<div class="line">*   <a class="code" href="ccmo_8h.html#acf68ddb88ebae9fd26d06458f408848e">run_deal_ex</a>(tid, pCmo);</div>
<div class="line">*   </div>
<div class="line">*   <span class="keywordtype">double</span> * collateral_balance;</div>
<div class="line">*   <span class="keywordtype">double</span> * coll_balance_gp1;</div>
<div class="line">*   <span class="keywordtype">double</span> * coll_balance_gp2;</div>
<div class="line">*   <span class="keywordtype">double</span> * coll_balance_gp3;</div>
<div class="line">*   <span class="keywordtype">double</span> * coll_balance_gp4;</div>
<div class="line">*   collateral_balance = <a class="code" href="ccmo_8h.html#a491f45b55e4ce48c00415b4b83f01025">get_collateral_flow_ex</a>(tid, 0, <a class="code" href="ccmo_8h.html#ad16bb3760880aef1036a60491d871577a356622c892d4c2cc8b7e6168e0ee919c">FLOW_COLLATERAL_BALANCE</a>);</div>
<div class="line">*   <span class="comment">//get balance flow from group 1</span></div>
<div class="line">*   coll_balance_gp1 = <a class="code" href="ccmo_8h.html#a491f45b55e4ce48c00415b4b83f01025">get_collateral_flow_ex</a>(tid, 1, <a class="code" href="ccmo_8h.html#ad16bb3760880aef1036a60491d871577a356622c892d4c2cc8b7e6168e0ee919c">FLOW_COLLATERAL_BALANCE</a>);</div>
<div class="line">*   <span class="comment">//get balance flow from group 2</span></div>
<div class="line">*   coll_balance_gp2 = <a class="code" href="ccmo_8h.html#a491f45b55e4ce48c00415b4b83f01025">get_collateral_flow_ex</a>(tid, 2, <a class="code" href="ccmo_8h.html#ad16bb3760880aef1036a60491d871577a356622c892d4c2cc8b7e6168e0ee919c">FLOW_COLLATERAL_BALANCE</a>);</div>
<div class="line">*   <span class="comment">//get balance flow from group 3</span></div>
<div class="line">*   coll_balance_gp3 = <a class="code" href="ccmo_8h.html#a491f45b55e4ce48c00415b4b83f01025">get_collateral_flow_ex</a>(tid, 3, <a class="code" href="ccmo_8h.html#ad16bb3760880aef1036a60491d871577a356622c892d4c2cc8b7e6168e0ee919c">FLOW_COLLATERAL_BALANCE</a>);</div>
<div class="line">*   <span class="comment">//get balance flow from group 4</span></div>
<div class="line">*   coll_balance_gp4 = <a class="code" href="ccmo_8h.html#a491f45b55e4ce48c00415b4b83f01025">get_collateral_flow_ex</a>(tid, 4, <a class="code" href="ccmo_8h.html#ad16bb3760880aef1036a60491d871577a356622c892d4c2cc8b7e6168e0ee919c">FLOW_COLLATERAL_BALANCE</a>);</div>
<div class="line">*   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i =0;i&lt;<a class="code" href="ccmo_8h.html#a8e145b85c6e0905b4b2525c3b69f3192">MAX_PERIODS</a>;i++){</div>
<div class="line">*       printf(<span class="stringliteral">&quot;Collateral Balance(0): %f&quot;</span>, collateral_balance[i]);</div>
<div class="line">*       printf(<span class="stringliteral">&quot;Collateral Balance(1): %f&quot;</span>, coll_balance_gp1[i]);</div>
<div class="line">*       printf(<span class="stringliteral">&quot;Collateral Balance(2): %f&quot;</span>, coll_balance_gp2[i]);</div>
<div class="line">*       printf(<span class="stringliteral">&quot;Collateral Balance(3): %f&quot;</span>, coll_balance_gp3[i]);</div>
<div class="line">*       printf(<span class="stringliteral">&quot;Collateral Balance(4): %f \n&quot;</span>, coll_balance_gp4[i]);</div>
<div class="line">*   }</div>
<div class="line">*  ...</div>
<div class="line">*  </div>
</div><!-- fragment --><h2><a class="anchor" id="sec_9_1_2"></a>
Bond cashflow</h2>
<p>Similar with retriving collateral cashflow, API provide two functions call to get bond cashflow <a class="el" href="ccmo_8h.html#a292eec0ddaa786ac39ea8f1b35085832">get_bond_flow_ex()</a> and <a class="el" href="ccmo_8h.html#af1da298150eafeb6f707f2792d36c049">get_bond_flow_ex1()</a>.</p>
<h2><a class="el" href="ccmo_8h.html#af1da298150eafeb6f707f2792d36c049">get_bond_flow_ex1()</a></h2>
<p>User should use <a class="el" href="ccmo_8h.html#af1da298150eafeb6f707f2792d36c049">get_bond_flow_ex1()</a>:</p>
<ul>
<li>Getting a set of bond cashflows by calling API function once</li>
<li>Getting underlying deal's bond cashflow</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>User should pass reremic_deal_id_or_null with NULL if the bondid indicating the bond in parent deal. <br/>
 User should pass reremic_deal_id_or_null with deal id if the bondid indicating the bond in underlying deal.</dd></dl>
<div class="fragment"><div class="line">*  ...</div>
<div class="line">*   <a class="code" href="ccmo_8h.html#acf68ddb88ebae9fd26d06458f408848e">run_deal_ex</a>(tid, pCmo);</div>
<div class="line">*   <span class="comment">// new MARKIT_BOND_CASHFLOW to hold bond cashflow result</span></div>
<div class="line">*   <a class="code" href="struct_m_a_r_k_i_t___b_o_n_d___c_a_s_h_f_l_o_w.html">MARKIT_BOND_CASHFLOW</a> * pMBC = <span class="keyword">new</span> <a class="code" href="struct_m_a_r_k_i_t___b_o_n_d___c_a_s_h_f_l_o_w.html">MARKIT_BOND_CASHFLOW</a>();</div>
<div class="line">*   <span class="comment">// return pointer to MARKIT_BOND_CASHFLOW structure with bond cashflow populated</span></div>
<div class="line">*   pMBC = <a class="code" href="ccmo_8h.html#af1da298150eafeb6f707f2792d36c049">get_bond_flow_ex1</a>(tid, NULL, <span class="stringliteral">&quot;1A24&quot;</span>);</div>
<div class="line">*   <span class="comment">// inspect the bond cashflow</span></div>
<div class="line">*   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;pMBC-&gt;<a class="code" href="struct_m_a_r_k_i_t___b_o_n_d___c_a_s_h_f_l_o_w.html#a5a1cb490031f7a3e47502c1f078355f8">size</a>;i++)</div>
<div class="line">*       printf(<span class="stringliteral">&quot;Balance:%f,Principal:%f,Interest:%f \n&quot;</span>,pMBC-&gt;<a class="code" href="struct_m_a_r_k_i_t___b_o_n_d___c_a_s_h_f_l_o_w.html#a76800e2d1af4ca0935776e8ece9e8e99">balance</a>[i],pMBC-&gt;<a class="code" href="struct_m_a_r_k_i_t___b_o_n_d___c_a_s_h_f_l_o_w.html#a22d6904b0f9168f8e3d9d49ab1c68029">principal</a>[i],pMBC-&gt;<a class="code" href="struct_m_a_r_k_i_t___b_o_n_d___c_a_s_h_f_l_o_w.html#a96824a18773ef5a3f2991ca93f0d399e">interest</a>[i]);</div>
<div class="line">*  ...        </div>
<div class="line">* </div>
</div><!-- fragment --><h2><a class="el" href="ccmo_8h.html#a292eec0ddaa786ac39ea8f1b35085832">get_bond_flow_ex()</a></h2>
<p>User should use <a class="el" href="ccmo_8h.html#a292eec0ddaa786ac39ea8f1b35085832">get_bond_flow_ex()</a> if he want to inspect cashflows that wasn't included in <a class="el" href="struct_m_a_r_k_i_t___b_o_n_d___c_a_s_h_f_l_o_w.html" title="This structure is used to provide user with bond cashflow. It has projected cashflow as well as possi...">MARKIT_BOND_CASHFLOW</a>.</p>
<dl class="section note"><dt>Note</dt><dd>Full list of available bond flow identifier : EXTENDED_FLOW_BOND_IDENTIFIER and others in <a class="el" href="ccmo_8h.html">ccmo.h</a> file (FLOW_BOND_BALANCE ..)</dd></dl>
<div class="fragment"><div class="line">*  ...</div>
<div class="line">*       <a class="code" href="ccmo_8h.html#acf68ddb88ebae9fd26d06458f408848e">run_deal_ex</a>(tid, pCmo);</div>
<div class="line">*       </div>
<div class="line">*       <span class="keywordtype">double</span> * bal_flow;</div>
<div class="line">*       <span class="keywordtype">double</span> * int_flow;</div>
<div class="line">*       <span class="keywordtype">double</span> * prin_flow;</div>
<div class="line">*   </div>
<div class="line">*      <span class="comment">//get_bond_flow_ex() returns a double pointer</span></div>
<div class="line">*       bal_flow = <a class="code" href="ccmo_8h.html#a292eec0ddaa786ac39ea8f1b35085832">get_bond_flow_ex</a>(tid, <span class="stringliteral">&quot;1A24&quot;</span>, <a class="code" href="ccmo_8h.html#a17927851ce78b3555e6b0d2060d77584">FLOW_BOND_BALANCE</a>);</div>
<div class="line">*       prin_flow = <a class="code" href="ccmo_8h.html#a292eec0ddaa786ac39ea8f1b35085832">get_bond_flow_ex</a>(tid, <span class="stringliteral">&quot;1A24&quot;</span>, <a class="code" href="ccmo_8h.html#a599e50f604977ad1d2f1a0cb89b5d3f3">FLOW_BOND_PRINCIPAL</a>);</div>
<div class="line">*       int_flow = <a class="code" href="ccmo_8h.html#a292eec0ddaa786ac39ea8f1b35085832">get_bond_flow_ex</a>(tid, <span class="stringliteral">&quot;1A24&quot;</span>, <a class="code" href="ccmo_8h.html#a1554fa048223f291e8488345da15e81d">FLOW_BOND_INTEREST</a>);</div>
<div class="line">*   </div>
<div class="line">*       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i =0;i&lt;<a class="code" href="ccmo_8h.html#a8e145b85c6e0905b4b2525c3b69f3192">MAX_PERIODS</a>;i++)</div>
<div class="line">*          <span class="comment">//length of cashflow vector is MAX_PERIODS</span></div>
<div class="line">*           printf(<span class="stringliteral">&quot;balance:%f,principal:%f,interest:%f \n&quot;</span>,bal_flow[i],prin_flow[i],int_flow[i]);</div>
<div class="line">*  ...</div>
<div class="line">*  </div>
</div><!-- fragment --><h1><a class="anchor" id="page_9_2"></a>
How to inspect underlying deals</h1>
<h2><a class="anchor" id="sec_9_2_1"></a>
Is this a reremic deal ?</h2>
<p>Calling <a class="el" href="ccmo_8h.html#a18e1d545d26520ea02cd866c7c47b55b">deal_has_underlying_deal()</a> is a quick way to identify if a deal has underlying deals. <br/>
 We can infer deal type by return value from <a class="el" href="ccmo_8h.html#a18e1d545d26520ea02cd866c7c47b55b">deal_has_underlying_deal()</a> : <br/>
 </p>
<table class="doxtable">
<tr>
<th>return value </th><th>meaning  </th></tr>
<tr>
<td>0</td><td>the deal only has normal loans as collateral <br/>
</td></tr>
<tr>
<td>1</td><td>the deal only has tranches from underlying deals as collateral <br/>
</td></tr>
<tr>
<td>2</td><td>the deal has a mix of normal loans and tranches from underlying deals as collateral <br/>
</td></tr>
</table>
<p>Sample code:</p>
<div class="fragment"><div class="line">*  ...</div>
<div class="line">*   <a class="code" href="ccmo_8h.html#a9fec86c2764699a30bc1f0d93d990e6a">open_deal_ex</a>(tid, pCmo);</div>
<div class="line">*   <span class="comment">//quick way to identify deal type</span></div>
<div class="line">*   printf(<span class="stringliteral">&quot;deal_has_underlying_deal: %d \n&quot;</span> ,<a class="code" href="ccmo_8h.html#a18e1d545d26520ea02cd866c7c47b55b">deal_has_underlying_deal</a>(tid));</div>
<div class="line">*  ...</div>
<div class="line">*  </div>
</div><!-- fragment --><h2><a class="anchor" id="sec_9_2_2"></a>
Inspect underlying deals</h2>
<p>Let assume a dummy reremic deal structure as follows :</p>
<blockquote class="doxtable">
<p>Deal Alpha(Parent deal) <br/>
|&ndash; Loan 1<br/>
|&ndash; Loan 2<br/>
|&ndash; Bond C from Deal Beta<br/>
 Deal Beta(Underlying deal)<br/>
|&ndash; Loan 3<br/>
|&ndash; Loan 4<br/>
|&ndash; Loan 5<br/>
|&ndash; Bond D from Deal Lambda<br/>
 </p>
</blockquote>
<p>Parent deal "Alpha" has 3 collaterals , one of them is a tranche "C" from deal "Beta". <br/>
 Parent deal "Beta" has 4 collaterals , one of them is a tranche "D" from deal "Lambda".</p>
<h2>Get underlying deal names</h2>
<p>User can get underlying deal names from <a class="el" href="struct_m_a_r_k_i_t___p_o_o_l___i_n_f_o.html#a670a7e04bfc9a49cf2ad0a03f20e7022" title="Remic deal name if reremic, null for a regular pool. ">MARKIT_POOL_INFO::remic_deal_name</a>. <br/>
 Given dummy example above, code below will return output "id:3, name:Beta, full_name:Beta-C" </p>
<div class="fragment"><div class="line">*  ...</div>
<div class="line">*   <a class="code" href="ccmo_8h.html#a9fec86c2764699a30bc1f0d93d990e6a">open_deal_ex</a>(tid, pCmo);</div>
<div class="line">*   <a class="code" href="struct_m_a_r_k_i_t___p_o_o_l___i_n_f_o.html">MARKIT_POOL_INFO</a>* mpi = 0;</div>
<div class="line">*   <span class="keywordtype">void</span>* coll_it =<a class="code" href="ccmo_8h.html#a503fc99cbd63b3dd9f240567346116e4">obtain_collat_iterator</a>(tid, 0);</div>
<div class="line">*   <span class="keywordflow">while</span>(mpi = <a class="code" href="ccmo_8h.html#ae568bf323c77a0269e15308fe76610a1">get_next_collat</a>(tid, coll_it)){</div>
<div class="line">*          <span class="comment">//MARKIT_POOL_INFO::remic_deal_name represents underlying deal name</span></div>
<div class="line">*       printf(<span class="stringliteral">&quot;id:%d, name:%s ,full_name:%s \n &quot;</span>,mpi-&gt;<a class="code" href="struct_m_a_r_k_i_t___p_o_o_l___i_n_f_o.html#abf97f8f12375c2338c3689e52b920ebe">loan_number</a>,mpi-&gt;<a class="code" href="struct_m_a_r_k_i_t___p_o_o_l___i_n_f_o.html#a670a7e04bfc9a49cf2ad0a03f20e7022">remic_deal_name</a>,mpi-&gt;<a class="code" href="struct_m_a_r_k_i_t___p_o_o_l___i_n_f_o.html#a707e87fdf10e9d901b912a56c7bf104d">id</a>);</div>
<div class="line">*   }</div>
<div class="line">*  ...</div>
<div class="line">*  </div>
</div><!-- fragment --><h2>Get all underlying deals info</h2>
<p>User can get details info about underlying deal by call <a class="el" href="ccmo_8h.html#a79f887ca7b4fca96a30b31c1f59527f4">view_reremic_deals()</a>. This function will popluate underlying deal information to an array of <a class="el" href="struct_c_m_o___s_t_r_u_c_t.html" title="This is the primary structure used to pass information to and from the WSA API. ">CMO_STRUCT</a>. <br/>
 Given dummy example above, code below will list deal name "Beta","Lambda" .</p>
<dl class="section note"><dt>Note</dt><dd>Calling this function requires all underlying deal files in the path set by <a class="el" href="ccmo_8h.html#a2da9487ad083f0bab496f9b9afe8850f">set_input_path()</a></dd></dl>
<div class="fragment"><div class="line">*  ...</div>
<div class="line">*   <a class="code" href="ccmo_8h.html#a9fec86c2764699a30bc1f0d93d990e6a">open_deal_ex</a>(tid, pCmo);</div>
<div class="line">*   <span class="comment">// get number of ALL underlying deals</span></div>
<div class="line">*   <span class="keywordtype">int</span> num_udy_deals = <a class="code" href="ccmo_8h.html#a79f887ca7b4fca96a30b31c1f59527f4">view_reremic_deals</a>(tid, NULL, NULL);</div>
<div class="line">*   printf(<span class="stringliteral">&quot;num of underlying deals: %d \n&quot;</span>, num_udy_deals);</div>
<div class="line">*   <span class="comment">//allocate space for CMO_STRUCT array</span></div>
<div class="line">*   <a class="code" href="struct_c_m_o___s_t_r_u_c_t.html">CMO_STRUCT</a>* udy_cmos = (<a class="code" href="struct_c_m_o___s_t_r_u_c_t.html">CMO_STRUCT</a>*)malloc(num_udy_deals*<span class="keyword">sizeof</span>(<a class="code" href="struct_c_m_o___s_t_r_u_c_t.html">CMO_STRUCT</a>));</div>
<div class="line">*   <span class="comment">//popluate udy_cmos with CMO_STRUCTs.</span></div>
<div class="line">*   <a class="code" href="ccmo_8h.html#a79f887ca7b4fca96a30b31c1f59527f4">view_reremic_deals</a>(tid, NULL, udy_cmos);</div>
<div class="line">*   <span class="comment">//list all underlying deal id</span></div>
<div class="line">*   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;num_udy_deals;i++)</div>
<div class="line">*       printf(<span class="stringliteral">&quot;underlying deal name: %s \n&quot;</span>, udy_cmos[i].dealid);</div>
<div class="line">*  ...</div>
<div class="line">*  </div>
</div><!-- fragment --><h1><a class="anchor" id="page_9_3"></a>
How to modify collateral using replace_collateral() ?</h1>
<p>User can overide some data fields in <a class="el" href="struct_m_a_r_k_i_t___p_o_o_l___i_n_f_o.html" title="This structure holds information about collateral. ">MARKIT_POOL_INFO</a> by calling <a class="el" href="ccmo_8h.html#a870663b9a59e1cb36e17012dcb9036e8">replace_collateral()</a>.</p>
<h2>Modify exsiting MARKIT_POOL_INFOs</h2>
<p>First step is to use get all collateral structures MARKIT_POOL_INFOs, modified them ,and save address of each <a class="el" href="struct_m_a_r_k_i_t___p_o_o_l___i_n_f_o.html" title="This structure holds information about collateral. ">MARKIT_POOL_INFO</a>.</p>
<dl class="section note"><dt>Note</dt><dd><a class="el" href="ccmo_8h.html#acf68ddb88ebae9fd26d06458f408848e">run_deal_ex()</a> will reset modification done to the MAKRIT_POO_INFOs. Make sure <a class="el" href="ccmo_8h.html#a870663b9a59e1cb36e17012dcb9036e8">replace_collateral()</a> was called after before <a class="el" href="ccmo_8h.html#acf68ddb88ebae9fd26d06458f408848e">run_deal_ex()</a>.</dd></dl>
<div class="fragment"><div class="line">*  ...</div>
<div class="line">*   <a class="code" href="ccmo_8h.html#a9fec86c2764699a30bc1f0d93d990e6a">open_deal_ex</a>(tid, pCmo);</div>
<div class="line">*  </div>
<div class="line">*   <span class="comment">// 2 dimensions pointer array to hold pointers to MARKIT_POOL_INFOs</span></div>
<div class="line">*   <a class="code" href="struct_m_a_r_k_i_t___p_o_o_l___i_n_f_o.html">MARKIT_POOL_INFO</a>** mpi_list = (<a class="code" href="struct_m_a_r_k_i_t___p_o_o_l___i_n_f_o.html">MARKIT_POOL_INFO</a>**)malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">void</span>*) * pCmo-&gt;<a class="code" href="struct_c_m_o___s_t_r_u_c_t.html#a4d23e60dc298e5e9daff26419f3b51b0">num_colls</a>);</div>
<div class="line">*   <span class="comment">// pointer points to the first element of mpi_list</span></div>
<div class="line">*   <a class="code" href="struct_m_a_r_k_i_t___p_o_o_l___i_n_f_o.html">MARKIT_POOL_INFO</a>** p = mpi_list;</div>
<div class="line">*   <span class="comment">// mpi pointer to be popluated by get_next_collat()</span></div>
<div class="line">*   <a class="code" href="struct_m_a_r_k_i_t___p_o_o_l___i_n_f_o.html">MARKIT_POOL_INFO</a>* mpi = 0;</div>
<div class="line">*  </div>
<div class="line">*   <span class="keywordtype">void</span>* coll_it =<a class="code" href="ccmo_8h.html#a503fc99cbd63b3dd9f240567346116e4">obtain_collat_iterator</a>(tid, 0);</div>
<div class="line">*   <span class="keywordflow">while</span>(mpi = <a class="code" href="ccmo_8h.html#ae568bf323c77a0269e15308fe76610a1">get_next_collat</a>(tid, coll_it)){</div>
<div class="line">*       printf(<span class="stringliteral">&quot;id:%d, balance:%f \n &quot;</span>,mpi-&gt;<a class="code" href="struct_m_a_r_k_i_t___p_o_o_l___i_n_f_o.html#abf97f8f12375c2338c3689e52b920ebe">loan_number</a>,mpi-&gt;<a class="code" href="struct_m_a_r_k_i_t___p_o_o_l___i_n_f_o.html#aa2d4bf62b9090642ef55cb1f008928fc">current_balance</a>);</div>
<div class="line">*       <span class="comment">// save address of mpi to mpi_list</span></div>
<div class="line">*       *p = mpi;</div>
<div class="line">*       <span class="comment">// move pointer to next element in array mpi_list</span></div>
<div class="line">*       p++;</div>
<div class="line">*       <span class="keywordflow">if</span>(mpi-&gt;<a class="code" href="struct_m_a_r_k_i_t___p_o_o_l___i_n_f_o.html#abf97f8f12375c2338c3689e52b920ebe">loan_number</a> &gt; 10){</div>
<div class="line">*           <span class="comment">// modify attribute of MARKIT_POOL_INFO</span></div>
<div class="line">*           mpi-&gt;<a class="code" href="struct_m_a_r_k_i_t___p_o_o_l___i_n_f_o.html#aa2d4bf62b9090642ef55cb1f008928fc">current_balance</a> *= 1.1;</div>
<div class="line">*       }</div>
<div class="line">*   }</div>
<div class="line">*  ...</div>
<div class="line">*  </div>
</div><!-- fragment --><p>After overriding changes have been done, User should call <a class="el" href="ccmo_8h.html#a870663b9a59e1cb36e17012dcb9036e8">replace_collateral()</a> to replace current exsiting collaterals with updated ones. </p>
<div class="fragment"><div class="line">*  ...</div>
<div class="line">*   <span class="comment">// replace collateral</span></div>
<div class="line">*   <a class="code" href="ccmo_8h.html#a870663b9a59e1cb36e17012dcb9036e8">replace_collateral</a>(tid, NULL, mpi_list, pCmo-&gt;<a class="code" href="struct_c_m_o___s_t_r_u_c_t.html#a4d23e60dc298e5e9daff26419f3b51b0">num_colls</a>);</div>
<div class="line">*  ...</div>
<div class="line">*  </div>
</div><!-- fragment --><p>Updated collateral can be retrived as following code: </p>
<div class="fragment"><div class="line">*  ...</div>
<div class="line">*   <span class="comment">// inspect mpi after changes</span></div>
<div class="line">*   coll_it =<a class="code" href="ccmo_8h.html#a503fc99cbd63b3dd9f240567346116e4">obtain_collat_iterator</a>(tid, 0);</div>
<div class="line">*   <span class="keywordflow">while</span>(mpi = <a class="code" href="ccmo_8h.html#ae568bf323c77a0269e15308fe76610a1">get_next_collat</a>(tid, coll_it)){</div>
<div class="line">*       printf(<span class="stringliteral">&quot;id:%d, balance:%f \n &quot;</span>,mpi-&gt;<a class="code" href="struct_m_a_r_k_i_t___p_o_o_l___i_n_f_o.html#abf97f8f12375c2338c3689e52b920ebe">loan_number</a>,mpi-&gt;<a class="code" href="struct_m_a_r_k_i_t___p_o_o_l___i_n_f_o.html#aa2d4bf62b9090642ef55cb1f008928fc">current_balance</a>);</div>
<div class="line">*   }</div>
<div class="line">*  ...</div>
<div class="line">*  </div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.4-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed May 22 2019 21:18:34 for WSA API REFERENCE GUIDE by
    <a href="http://www.moodysanalytics.com/">
   Moody's Analytics SAV</a> </li>
  </ul>
</div>
</body>
</html>
